<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Valentine?</title>
  <style>
    * { box-sizing: border-box; }
    body{
      margin:0;
      height:100vh;
      overflow:hidden;
      font-family: Arial, sans-serif;
      display:grid;
      place-items:center;
      background:#5c0606;
    }

    .panel{
      width:min(420px, 90vw);
      padding:24px;
      border:2px solid #000;
      border-radius:18px;
      text-align:center;
      background:#a67575;
      position: relative;
      z-index: 2;
    }

    h1{ margin:0 0 18px; font-size:24px; }

    .btn-row{
      display:flex;
      gap:12px;
      justify-content:center;
      align-items:center;
      height:52px;
      position:relative;
    }

    button{
      padding:12px 18px;
      font-size:16px;
      border-radius:12px;
      border:2px solid #000;
      background:#fff;
      cursor:pointer;
      user-select:none;
    }

    #yesBtn{ background:#000; color:#fff; }

    /* No starts normal */
    #noBtn{ position: static; }

    .message{
      margin-top:14px;
      font-size:18px;
      display:none;
    }

    /* ---- Fireworks canvas ---- */
    #fwCanvas{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 1; /* behind panel (panel is z-index 2) */
      display: none;
    }
  </style>
</head>
<body>

  <!-- Fireworks overlay -->
  <canvas id="fwCanvas"></canvas>

  <div class="panel" id="panel">
    <h1 id="titleText">Will you be my valentine ðŸ’˜</h1>

    <div class="btn-row" id="btnRow">
      <button id="yesBtn">Yes</button>
      <button id="noBtn">No</button>
    </div>

    <div class="message" id="msg">I LOVE YOU ! ðŸ’–</div>
  </div>

  <script>
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const msg = document.getElementById("msg");
    const titleText = document.getElementById("titleText");

    // ---- Fireworks setup ----
    const canvas = document.getElementById("fwCanvas");
    const ctx = canvas.getContext("2d");
    let particles = [];
    let animId = null;
    let fireworksEndAt = 0;

    function resizeCanvas(){
      canvas.width = window.innerWidth * devicePixelRatio;
      canvas.height = window.innerHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function spawnFireworkBurst(x, y){
      const count = Math.floor(rand(60, 110));
      for(let i=0;i<count;i++){
        const angle = rand(0, Math.PI * 2);
        const speed = rand(2, 6);
        particles.push({
          x, y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          life: rand(35, 70),
          size: rand(1.5, 3.5),
          gravity: 0.06,
          drag: 0.985,
          // random bright colour
          hue: rand(0, 360)
        });
      }
    }

    function animateFireworks(){
      ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);

      // fade trail
      ctx.fillStyle = "rgba(255,255,255,0.15)";
      ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);

      for(let i = particles.length - 1; i >= 0; i--){
        const p = particles[i];
        p.vx *= p.drag;
        p.vy *= p.drag;
        p.vy += p.gravity;

        p.x += p.vx;
        p.y += p.vy;
        p.life -= 1;

        // draw
        ctx.beginPath();
        ctx.fillStyle = `hsla(${p.hue}, 95%, 55%, ${Math.max(p.life/70, 0)})`;
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fill();

        if(p.life <= 0) particles.splice(i, 1);
      }

      // keep spawning bursts for a short duration
      const now = performance.now();
      if(now < fireworksEndAt){
        if(Math.random() < 0.20){
          spawnFireworkBurst(rand(80, window.innerWidth - 80), rand(80, window.innerHeight * 0.6));
        }
      }

      // stop when time is up AND particles finished
      if(now >= fireworksEndAt && particles.length === 0){
        cancelAnimationFrame(animId);
        animId = null;
        canvas.style.display = "none";
        ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
        return;
      }

      animId = requestAnimationFrame(animateFireworks);
    }

    function startFireworks(durationMs = 2500){
      canvas.style.display = "block";
      fireworksEndAt = performance.now() + durationMs;

      // first big burst in the middle top-ish
      spawnFireworkBurst(window.innerWidth * 0.5, window.innerHeight * 0.35);
      spawnFireworkBurst(window.innerWidth * 0.3, window.innerHeight * 0.45);
      spawnFireworkBurst(window.innerWidth * 0.7, window.innerHeight * 0.45);

      if(!animId) animateFireworks();
    }

    // ---- No button runaway ----
    function clamp(n, min, max) {
      return Math.max(min, Math.min(max, n));
    }

    function moveNoButtonAnywhere() {
      if (getComputedStyle(noBtn).position !== "fixed") {
        noBtn.style.position = "fixed";
        noBtn.style.zIndex = "9999";
      }

      const vw = window.innerWidth;
      const vh = window.innerHeight;

      const bw = noBtn.offsetWidth;
      const bh = noBtn.offsetHeight;

      const pad = 10;

      const x = Math.floor(Math.random() * (vw - bw - pad * 2)) + pad;
      const y = Math.floor(Math.random() * (vh - bh - pad * 2)) + pad;

      noBtn.style.left = clamp(x, pad, vw - bw - pad) + "px";
      noBtn.style.top  = clamp(y, pad, vh - bh - pad) + "px";
    }

    noBtn.addEventListener("click", moveNoButtonAnywhere);

    // ---- Yes click (show message + fireworks) ----
    yesBtn.addEventListener("click", () => {
      msg.style.display = "block";
      titleText.textContent = "NYCKEðŸ’˜";

      noBtn.style.display = "none";
      yesBtn.disabled = true;

      // Fireworks appear when Yes is clicked
      startFireworks(3000);
    });
  </script>
</body>
</html>
